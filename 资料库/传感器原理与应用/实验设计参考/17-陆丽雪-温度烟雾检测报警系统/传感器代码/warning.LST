C51 COMPILER V9.56.0.0   WARNING                                                           12/18/2019 10:58:23 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE WARNING
OBJECT MODULE PLACED IN warning.OBJ
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE warning.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include "STC15F2K60S2.h"
   2          #include "intrins.h"
   3          #include "onewire.h"
   4          #include "iic.h"    //I2C×ÜÏßÇý¶¯¿â 
   5          
   6          code unsigned char seg7code[10]={ 0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90}; //ÏÔÊ¾¶ÎÂë ÊýÂë¹Ü×Ö¸
             -ú
   7          unsigned char wei[4]={0XEf,0XDf,0XBf,0X7f};  //Î»µÄ¿ØÖÆ¶Ë                //Î»¿ØÖÆÂë
   8          code unsigned char tab[] = { 0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90,0xff };
   9          unsigned char dspbuf[8] = {10,10,10,10,10,0,0,0};  //ÏÔÊ¾»º³åÇø
  10          unsigned char dspcom = 0;
  11          unsigned char ad_value, intr;
  12          bit flag_100;
  13          
  14          
  15          sbit CLK = P3^7;  //Ê±ÖÓÂö³å  
  16          sbit SE = P1^2;   // LCDÊ¹ÄÜ¶Ë¿Ú
  17          sbit RW = P2^1;   // LCD¶ÁÐ´¶Ë¿Ú
  18          sbit RS = P2^0;   // LCDÐ´Êý¾Ý»òÐ´ÃüÁî¶Ë¿Ú
  19          sbit DQ = P1^4;   // ¶¨ÒåP1^4¿ÚÎªDS18B20µÄÊý¾Ý¿Ú
  20          sbit S7 = P3^0;
  21          sbit S6 = P3^1;
  22          sbit S5 = P3^2;
  23          sbit S4 = P3^3;
  24          sbit LED = P0^0;   //¶¨Òåµ¥Æ¬»úP1¿ÚµÄµÚ1Î» £¨¼´P1.0£©ÎªÖ¸Ê¾¶Ë
  25          sbit DOUT = P2^0;  //¶¨Òåµ¥Æ¬»úP2¿ÚµÄµÚ1Î» £¨¼´P2.0£©Îª´«¸ÐÆ÷µÄÊäÈë¶Ë,
  26          
  27          
  28          unsigned int Temp;
  29          unsigned int ND;
  30          unsigned char du1[16];
  31          unsigned char display[16];
  32          unsigned char date[8];
  33          unsigned char max1 = 30;
  34          unsigned char max2 = 30;
  35          unsigned char disflag = 0;
  36          unsigned char tempflag = 0;
  37          
  38          
  39          
  40          void Delay10ms()    //@11.0592MHz
  41          {
  42   1        unsigned char i, j;
  43   1      
  44   1        i = 108;
  45   1        j = 145;
  46   1        do
  47   1        {
  48   2          while (--j);
  49   2        } 
  50   1        while (--i);
  51   1      }
  52          
  53          void Delay10us()    //@11.0592MHz
  54          {
C51 COMPILER V9.56.0.0   WARNING                                                           12/18/2019 10:58:23 PAGE 2   

  55   1        unsigned char i;
  56   1      
  57   1        _nop_();
  58   1        i = 25;
  59   1        while (--i);
  60   1      }
  61          
  62          
  63          void Delay5ms()   //@11.0592MHz
  64          {
  65   1        unsigned char i, j;
  66   1      
  67   1        i = 54;
  68   1        j = 199;
  69   1        do
  70   1        {
  71   2          while (--j);
  72   2        } while (--i);
  73   1      }
  74          
  75          
  76          void delay()//Êä³öÑÓÊ±³ÌÐò
  77          {
  78   1      unsigned char m,n,s;
  79   1      for(m=20;m>0;m--)
  80   1      for(n=20;n>0;n--)
  81   1      for(s=248;s>0;s--);
  82   1      }
  83          void LCD_COM(unsigned char dat)    //LCDÐ´ÃüÁî
  84          {
  85   1         Delay5ms();
  86   1         RW = 0; //0Ð´Êý¾Ý 1¶ÁÊý¾Ý
  87   1         RS = 0; //0Ð´ÃüÁî 1¶ÁÃüÁî
  88   1         
  89   1         SE = 1;
  90   1         P0 = dat;  //LCDÊý¾Ý¶Ë¿Ú
  91   1      
  92   1         SE = 0;    //±£³ÖÊý¾ÝÏÂ½µÑØ´«ÊäÊý¾Ý
  93   1      }
  94          
  95          void LCD_write(unsigned char dat)   //LCDÐ´Êý¾Ý
  96          {
  97   1         Delay5ms();
  98   1         RW = 0;  //0Ð´Êý¾Ý 1¶ÁÊý¾Ý
  99   1         RS = 1;   //0Ð´ÃüÁî 1Ð´Êý¾Ý
 100   1         
 101   1         SE = 1;
 102   1         P0 = dat;   //LCDÊý¾Ý¶Ë¿Ú
 103   1         
 104   1         SE = 0;      //±£³ÖÊý¾ÝÏÂ½µÑØ´«ÊäÊý¾Ý
 105   1      }
 106          
 107          void LCD_init() //LCD³õÊ¼»¯
 108          {
 109   1      
 110   1         LCD_COM(0x38); //£¨0x38¿ª5*7·½Õó£¬0x3c¿ª5*10·½Õó£©8Î»×ÜÏß£¬ÏÔÊ¾Á½ÐÐ£¬ÎÞ¹â±ê£¬5*7µãÕó
 111   1         LCD_COM(0x01); //ÇåÆÁ
 112   1         LCD_COM(0x06); //£¨0x06Ð´Ò»¸ö¹â±êºóÒÆ£¬0x04¹â±ê×óÒÆ£¬0x07ÆÁÄ»ÓÒÒÆÇÒ¹â±êºóÒÆ£©¹â±êºóÒÆ£¬ÏÔÊ¾ÆÁ²»ÓÒÒÆ
 113   1         LCD_COM(0x0c); //£¨0x0eÏÔÊ¾¹â±ê²»ÉÁË¸£¬0x0f¿ª¹â±êÉÁË¸£©B2Î»ÏÔÊ¾¿ª£¬ÎÞ¹â±ê£¬²»ÉÁË¸
 114   1      }
 115          void timer0( ) interrupt 1 //¶¨Ê±Æ÷0¹¤×÷·½Ê½1
 116          {
C51 COMPILER V9.56.0.0   WARNING                                                           12/18/2019 10:58:23 PAGE 3   

 117   1      
 118   1      TH0=(65536-2)/256;    //ÖØ×°¼ÆÊý³õÖµ
 119   1      TL0=(65536-2)%256;    //ÖØ×°¼ÆÊý³õÖµ
 120   1      CLK=!CLK;       //È¡·´
 121   1      }
 122          
 123          void isr_timer_0(void)  interrupt 1  //Ä¬ÈÏÖÐ¶ÏÓÅÏÈ¼¶ 1
 124          {
 125   1          TH0 = (65536-2000)/256;
 126   1          TL0 = (65536-2000)%256;  //¶¨Ê±Æ÷ÖØÔØ 
 127   1          if(++intr==50)
 128   1          {
 129   2            flag_100=1;
 130   2            intr=0;
 131   2          }
 132   1      }
 133          unsigned int ReadTemp(void)    //DS18B20¶ÁÈ¡ÎÂ¶È
 134          {
 135   1           unsigned char TH,TL;
 136   1        unsigned int temp;
 137   1        unsigned int tt;
 138   1         
 139   1         init_ds18b20();   //³õÊ¼»¯
 140   1         Write_DS18B20(0xcc); //Ìø¹ýÑ¡ÔñROM
 141   1         Write_DS18B20(0x44); //Æô¶¯×ª»»ÃüÁî
 142   1        
 143   1         init_ds18b20();   //ÔÙ´Î³õÊ¼»¯
 144   1         Write_DS18B20(0xcc);
 145   1         Write_DS18B20(0xbe);  //¶ÁÈ¡Êý¾ÝÃüÁî
 146   1        
 147   1         TL = Read_DS18B20();
 148   1         TH = Read_DS18B20();
 149   1        
 150   1          temp = ((TH << 8) | TL); //¾«È·µ½Ð¡Êý
 151   1        tt = temp * 10 * 0.0625 + 0.05; //¾«È·µ½Ð¡ÊýºóÒ»Î»
 152   1        
 153   1         return tt;
 154   1      }
 155          
 156          void init_pcf8591(unsigned char channel)
 157          {
 158   1        IIC_Start();
 159   1        IIC_SendByte(0x90);
 160   1        IIC_WaitAck();
 161   1        IIC_SendByte(channel);  //ADCÍ¨µÀ3
 162   1        IIC_WaitAck();
 163   1        IIC_Stop();
 164   1        Delay10us();
 165   1      }
 166          
 167          unsigned char read_pcf8591(void)
 168          {
 169   1        unsigned char ND;
 170   1      
 171   1        IIC_Start();
 172   1        IIC_SendByte(0x91);
 173   1        IIC_WaitAck();
 174   1        ND = IIC_RecByte();
 175   1        IIC_Ack(0);     //·¢ËÍ·ÇÓ¦´ðÐÅºÅ 
 176   1        IIC_Stop();
 177   1        
 178   1        return ND;
C51 COMPILER V9.56.0.0   WARNING                                                           12/18/2019 10:58:23 PAGE 4   

 179   1      }
 180          void display1() //LCDµÚÒ»ÐÐÏÔÊ¾
 181          {
 182   1        unsigned char test1,test2;
 183   1        Temp = ReadTemp();
 184   1        while (Temp != ReadTemp())
 185   1        Temp = ReadTemp();
 186   1        ND = read_pcf8591();
 187   1        while (ND != read_pcf8591())
 188   1        ND = read_pcf8591();
 189   1        if(disflag==0)
 190   1        {
 191   2          du1[0] = 'T';
 192   2          du1[1] =' ';
 193   2          du1[2] = Temp / 100 % 10 + 0x30; //£«0x30µÄÔ­ÒòÊÇÊý×ÖÔÚLCD²»ÄÜÏÔÊ¾Òª×ª»¯³É×Ö·û¾ÍÊÇAIISCÂë;
 194   2          du1[3] = Temp / 10 % 10 + 0x30;
 195   2          du1[4] = '.';
 196   2          du1[5] = Temp % 10 + 0x30;
 197   2          du1[6] = 0xdf;
 198   2          du1[7] = 'C';
 199   2          du1[8] = ' ';
 200   2          du1[9] = 'N';
 201   2          du1[10] =' ';
 202   2          du1[11] = ND / 100 % 10 + 0x30;
 203   2          du1[12] = ND / 10 % 10 + 0x30;
 204   2          du1[13] ='.';
 205   2          du1[14] =ND % 10 + 0x30;
 206   2          du1[15] =' ';
 207   2        
 208   2        }
 209   1        if(disflag==1)
 210   1        {
 211   2          du1[0] = ' ';
 212   2            du1[1] = ' ';
 213   2            du1[2] = ' ';
 214   2            du1[3] = ' ';
 215   2            du1[4] = ' ';
 216   2          du1[5] = ' ';
 217   2          du1[6] = ' ';
 218   2            du1[7] = ' ';
 219   2          du1[8] = ' ';
 220   2          du1[9] = ' ';
 221   2          du1[10] =' ';
 222   2          du1[11] =' ';
 223   2          du1[12] =' ';
 224   2          du1[13] =' ';
 225   2          du1[14] =' ';
 226   2          du1[15] =' ';
 227   2        } 
 228   1      
 229   1        test1 = Temp / 100 % 10 * 10 + Temp / 10 % 10;
 230   1        test2 = ND / 100 % 10 * 10 + ND / 10 % 10;
 231   1        if (test1 >= max1||test2 >= max2)
 232   1        {
 233   2          P06 = 1;
 234   2          P04 = 1;
 235   2          P2 = ((P2 & 0x1f) | 0xA0);
 236   2          P2 &= 0x1f;
 237   2          P0=0x00;
 238   2          P2 = ((P2 & 0x1f) | 0x80);
 239   2          P2 &= 0x1f;
 240   2          
C51 COMPILER V9.56.0.0   WARNING                                                           12/18/2019 10:58:23 PAGE 5   

 241   2        }
 242   1        else 
 243   1        {
 244   2          P06 = 0;
 245   2          P04 = 0;
 246   2          P2 = ((P2 & 0x1f) | 0xA0);
 247   2          P2 &= 0x1f;
 248   2        } 
 249   1      }
 250          
 251          void display2() //LCDµÚ¶þÐÐÏÔÊ¾
 252          {
 253   1        if(disflag==0)
 254   1        {
 255   2          display[0] = 'T';
 256   2          display[1] = 'M';
 257   2          display[2] = 'A';
 258   2          display[3] = 'X';
 259   2          display[4] = ' '; 
 260   2          display[5] = max1 / 10 + 0x30;
 261   2          display[6] = max1 % 10 + 0x30;
 262   2          display[7] = ' ';
 263   2          display[8] = 'N';
 264   2          display[9] = 'M';
 265   2          display[10] = 'A';
 266   2          display[11] = 'X';
 267   2          display[12] = ' ';
 268   2          display[13] = max2/ 10 + 0x30;
 269   2          display[14] = max2 % 10 + 0x30;
 270   2          display[15] = ' '; 
 271   2        }
 272   1      }
 273          
 274          void key_scan()
 275          {   
 276   1        if(S7 == 0)
 277   1        {
 278   2          Delay10ms();
 279   2            if(S7 == 0)
 280   2            {       
 281   3              disflag++;
 282   3              if(disflag==2)
 283   3              disflag=0;
 284   3            }
 285   2            while(S7 == 0);
 286   2          }
 287   1      
 288   1        if(S6 == 0)
 289   1        {
 290   2          Delay10ms();
 291   2            if(S6 == 0)
 292   2            {       
 293   3              tempflag++;
 294   3              if(tempflag==2)
 295   3              tempflag=0;
 296   3            }
 297   2            while(S7 == 0);
 298   2          }
 299   1      
 300   1        if(S4 == 0)
 301   1        {
 302   2          Delay10ms();
C51 COMPILER V9.56.0.0   WARNING                                                           12/18/2019 10:58:23 PAGE 6   

 303   2            if(S4 == 0)
 304   2          {
 305   3            if(tempflag==1)     
 306   3            {
 307   4              max2--;
 308   4            }
 309   3            if(tempflag==0)     
 310   3            {       
 311   4              max1--;
 312   4              if(max1 == 255)
 313   4              max1 = 0;
 314   4            }
 315   3          }
 316   2          while(S4 == 0);
 317   2          }
 318   1        if(S5 == 0)
 319   1        {
 320   2          Delay10ms();
 321   2            if(S5 == 0)
 322   2          {
 323   3            if(tempflag==1)       
 324   3            {
 325   4              max2++;
 326   4              if(max1 == 99)
 327   4              max2 = 99;
 328   4            }
 329   3            if(tempflag==0)       
 330   3            {       
 331   4              max1++;
 332   4        
 333   4            }
 334   3          
 335   3          while(S5 == 0);
 336   3          }   
 337   2      }
 338   1        }
 339          
 340          void main()
 341          {
 342   1          unsigned char reset_cnt=0;  //¿ª»ú´ÎÊý´æ´¢ (×î´ó´æ´¢Öµ255)
 343   1        unsigned char i,j;
 344   1          P2=0xa0;P0=0x00;P2=0x00;
 345   1          P2=0x80;P0=0xff;P2=0x00;
 346   1          P2=0xe0;P0=0xff;P2=0x00;
 347   1          LCD_init();
 348   1        
 349   1          TMOD=0X01;        //¶¨Ê±Æ÷ÖÐ¶Ï0
 350   1          CLK=0;          //Âö³åÐÅºÅ³õÊ¼ÖµÎª0
 351   1          TH0=(65536-2)/256;    //¶¨Ê±Ê±¼ä¸ß°ËÎ»³õÖµ
 352   1          TL0=(65536-2)%256;    //¶¨Ê±Ê±¼äµÍ°ËÎ»³õÖµ
 353   1          EA=1;         //¿ªCPUÖÐ¶Ï
 354   1          ET0=1;          //¿ªT/C0ÖÐ¶Ï
 355   1          TR0=1;
 356   1          
 357   1              
 358   1         /* TMOD |= 0x01;  //ÅäÖÃ¶¨Ê±Æ÷¹¤×÷Ä£Ê½
 359   1          TH0 = (65536-2000)/256;
 360   1          TL0 = (65536-2000)%256;  
 361   1          EA = 1;
 362   1          ET0 = 1;  //´ò¿ª¶¨Ê±Æ÷ÖÐ¶Ï
 363   1          TR0 = 1;  //Æô¶¯¶¨Ê±Æ÷*/
 364   1      
C51 COMPILER V9.56.0.0   WARNING                                                           12/18/2019 10:58:23 PAGE 7   

 365   1          while(1)
 366   1          {
 367   2            if(flag_100)
 368   2            { 
 369   3              flag_100=0;
 370   3              init_pcf8591(0x03); 
 371   3              ND= read_pcf8591();
 372   3            }
 373   2            display1();
 374   2            LCD_COM(0x80); //ÏÔÊ¾µÚÒ»ÐÐ
 375   2            for(i = 0;i < 16;i++)
 376   2            LCD_write(du1[i]);
 377   2      
 378   2            LCD_COM(0x40 + 0x80); //ÏÔÊ¾µÚ¶þÐÐ
 379   2            display2();
 380   2            for(j = 0;j < 16;j++)
 381   2            LCD_write(display[j]);
 382   2      
 383   2            key_scan();
 384   2            LED=1;     //Ï¨ÃðP1.0¿ÚµÆ
 385   2            if(DOUT==1)//µ±Å¨¶È¸ßÓÚÉè¶¨ÖµÊ± £¬Ö´ÐÐÌõ¼þº¯Êý
 386   2           {
 387   3              delay();//ÑÓÊ±¿¹¸ÉÈÅ
 388   3            if(DOUT==1)//È·¶¨ Å¨¶È¸ßÓÚÉè¶¨ÖµÊ± £¬Ö´ÐÐÌõ¼þº¯Êý
 389   3              {
 390   4                LED=0;     //µãÁÁP1.0¿ÚµÆ
 391   4              }
 392   3           }
 393   2         }
 394   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    986    ----
   CONSTANT SIZE    =     21    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     63       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
